/*! Livetube Notifier v1.3.0 Github repo: https://github.com/sekai013/Livetube-Notifier */
$(function(){"use strict";var a,b;chrome.runtime.onMessage.addListener(function(a){var b;return b={updatePopup:function(){var b,c,d,e,f,g,h,i,j,k;for($("#videoContainer").empty(),j=a.videos,k=[],h=0,i=j.length;i>h;h++)g=j[h],c=$('<div class="video">'),d=$("#hServer")[0].checked?"http://h.livetube.cc/":"http://livetube.cc/",f=$("<span>").html("配信名: <a href="+d+g.link+' target="_blank">'+g.title+"</a>"),b=$("<span>").html("配信者名: <a href="+d+encodeURI(g.author)+' target="_blank">'+g.author+"</a>"),e=g.tags.map(function(a){return"<a href="+d+"tag."+encodeURI(a)+' target="_blank">'+a+"</a>"}),e=$("<span>").html("タグ: "+e.join(",")),c.append(f).append("<br>").append(b).append("<br>").append(e),k.push($("#videoContainer").append(c));return k}},a.action in b?b[a.action]():void 0}),b=function(a,b){return chrome.runtime.sendMessage(chrome.runtime.id,{action:"updateStatus",property:a,newValue:b})},$("#mainContainer").on("click","#videoToggle",function(a){return $(a.target).hasClass("getting")?($(a.target).removeClass("getting").text("配信取得開始"),chrome.runtime.sendMessage(chrome.runtime.id,{action:"stopGettingVideos"})):($(a.target).addClass("getting").text("配信取得停止"),chrome.runtime.sendMessage(chrome.runtime.id,{action:"startGettingVideos"}))}),$("#mainContainer").on("change","#updateIntervalSelector",function(a){return b("updateIntervalInMinutes",a.target.value)}),$("#mainContainer").on("change","#hServer",function(a){var c,d;return b("useHServer",a.target.checked),a.target.checked===!0?(d="http://",c="http://h."):(d="http://h.",c="http://"),$("#videoContainer").find("a").each(function(a,b){return b.href=b.href.replace(d,c)})}),$("#mainContainer").on("change","#autoOpen",function(a){return b("autoOpen",a.target.checked)}),$("#mainContainer").on("click","#registerButton",function(){var a,b,c,d,e;if(""!==(c=$("#word").val()))return d=$("#wordTypeSelector").val(),e={type:d,text:c,id:Date.now().toString()},a=$("<button>").addClass("btn btn-default btn-xs deleteButton").attr("id",""+e.id+"_delete").html('<span class="glyphicon glyphicon-remove"></span>'),b=$("<span>").attr("id",e.id).text(e.text),chrome.runtime.sendMessage(chrome.runtime.id,{action:"registerWord",word:e}),$("#"+e.type+"Container").append(a).append(b),$("#word").val("")}),$("#mainContainer").on("click",".deleteButton",function(){var a;return a=this.id.split("_")[0],$("#"+a).remove(),$(this).remove(),chrome.runtime.sendMessage(chrome.runtime.id,{action:"deleteWord",id:a})}),$(".tab-menu").on("click",function(){return $(".tab-menus").children().removeClass("active"),$(this).addClass("active")}),a=function(){var a,b,c;return a=$("#mainContainer"),c={"#videos":function(){return chrome.runtime.getBackgroundPage(function(b){var c,d;return c=b.storage.status.status,d=$("#videosTemplate").html(),a.html(d),c.gettingVideos&&($("#videoToggle").addClass("getting").text("配信取得停止"),chrome.runtime.sendMessage(chrome.runtime.id,{action:"updateVideos"})),$("#hServer").prop("checked",c.useHServer),$("#autoOpen").prop("checked",c.autoOpen),$("#min"+c.updateIntervalInMinutes)[0].selected=!0})},"#words":function(){return chrome.runtime.getBackgroundPage(function(b){var c,d,e,f,g,h,i,j;for(g=b.storage.words.words,e=$("#wordsTemplate").html(),a.html(e),j=[],h=0,i=g.length;i>h;h++)f=g[h],c=$("<button>").addClass("btn btn-default btn-xs deleteButton").attr("id",""+f.id+"_delete").html('<span class="glyphicon glyphicon-remove"></span>'),d=$("<span>").attr("id",f.id).text(f.text),j.push($("#"+f.type+"Container").append(c).append(d));return j})}},b=window.location.hash,b in c?c[b]():window.location.hash="#videos"},window.onhashchange=a,a()});